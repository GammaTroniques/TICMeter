<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@6.9.96/css/materialdesignicons.min.css">
    <script src="https://cdn.socket.io/4.4.1/socket.io.min.js" integrity="sha384-fKnu0iswBIqkjxrhQCTZ7qlLHOFEgNkRmK2vaO/LbTZSXdJfAu6ewRBdwHPhBo/H" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> -->
    <script src="https://unpkg.com/vue-chartjs@2.8.7/dist/vue-chartjs.full.min.js"></script>

    <title>Linky</title>
</head>

<body>
    <div class="widget-container">
        <div class="side">
            <div class="widget">
                <div class="header">
                    <h1>État</h1>
                    <span class="mdi mdi-cog"></span>
                </div>
                <div class="state-content">
                    <svg width="137" height="230" viewBox="0 0 157 236" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <mask id="mask0_7_265" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0"
                            width="157" height="236">
                            <path d="M0 0H156.818V236H0V0Z" fill="white" />
                        </mask>
                        <g mask="url(#mask0_7_265)">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M156.818 227.552C156.818 232.233 152.367 236.019 146.834 236L9.9562 235.8C4.46175 235.795 0 231.998 0 227.338V8.43027C0 3.77067 4.46175 -0.0251466 9.9562 -0.000814454L146.834 0.196055C152.367 0.222599 156.818 4.00071 156.818 8.66142V227.552Z"
                                fill="#BBD41F" />
                        </g>
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M124.824 157.409C124.824 162.346 120.1 166.348 114.28 166.356L33.3966 166.224C27.5735 166.224 22.8337 162.193 22.8337 157.241V57.7783C22.8337 52.83 27.5735 48.8163 33.3966 48.8329L114.28 48.9524C120.1 48.9612 124.824 52.9782 124.824 57.942V157.409Z"
                            fill="#B7C243" />
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M124.824 157.409C124.824 162.346 120.1 166.348 114.28 166.356L33.3966 166.224C27.5735 166.224 22.8337 162.193 22.8337 157.241V57.7783C22.8337 52.83 27.5735 48.8163 33.3966 48.8329L114.28 48.9524C120.1 48.9612 124.824 52.9782 124.824 57.942V157.409Z"
                            stroke="#B7C243" stroke-width="0.365" />
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M126.576 149.693C126.576 154.362 122.11 158.129 116.605 158.144L40.2126 158.024C34.7076 158.015 30.2283 154.215 30.2283 149.532V55.5866C30.2283 50.9138 34.7076 47.1235 40.2126 47.1345L116.605 47.2473C122.11 47.2507 126.576 51.0454 126.576 55.7382V149.693Z"
                            fill="#CFCEC4" />
                        <mask id="mask1_7_265" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="34" y="49"
                            width="89" height="103">
                            <path d="M34.3432 49.6647H122.439V151.852H34.3432V49.6647Z" fill="white" />
                        </mask>
                        <g mask="url(#mask1_7_265)">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M122.438 144.082C122.438 148.376 118.362 151.844 113.332 151.852L43.4722 151.755C38.4452 151.738 34.3423 148.238 34.3423 143.933V57.4498C34.3423 53.1416 38.4452 49.6645 43.4722 49.6645L113.332 49.7748C118.362 49.7893 122.438 53.2742 122.438 57.5869V144.082Z"
                                fill="#F9F9F7" />
                        </g>
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M76.9301 157.212L53.7915 157.26V142.998L76.9301 142.939V157.212Z" stroke="#7F8074"
                            stroke-width="0.219" />
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M107.018 157.371L83.9009 157.428V143.138L107.018 143.106V157.371Z" stroke="#7F8074"
                            stroke-width="0.219" />
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M47.4438 98.1305V119.241L112.327 119.336V98.2142L47.4438 98.1305Z" fill="#9AA3AB" />
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M47.4438 140.681C47.4438 141.938 48.6665 142.963 50.1454 142.975L109.616 143.057C111.11 143.066 112.327 142.021 112.327 140.752V119.336L47.4438 119.24V140.681Z"
                            fill="#4F4F4F" />
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M112.327 77.8232C112.327 76.543 111.11 75.5215 109.616 75.538L50.1444 75.4467C48.6666 75.4225 47.4428 76.4759 47.4428 77.7439V98.1309L112.327 98.2145V77.8232Z"
                            fill="#4F4F4F" />
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M127.326 149.057C127.326 153.703 122.873 157.452 117.384 157.467L41.2198 157.348C35.7312 157.339 31.2652 153.557 31.2652 148.896V55.3975C31.2652 50.7468 35.7312 46.9746 41.2198 46.9856L117.384 47.0978C122.873 47.1011 127.326 50.8778 127.326 55.5483V149.057Z"
                            stroke="#B7C243" stroke-width="0.365" />
                        <mask id="mask2_7_265" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="69" y="209"
                            width="17" height="10">
                            <path
                                d="M69.8483 209.968V218.021C69.8483 218.318 70.1022 218.553 70.4123 218.557L84.6259 218.679C84.9349 218.679 85.1888 218.439 85.1888 218.147V210.109C85.1888 209.822 84.9349 209.594 84.6259 209.588L70.4123 209.445C70.1022 209.453 69.8483 209.684 69.8483 209.968Z"
                                fill="white" />
                        </mask>
                        <g mask="url(#mask2_7_265)">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M85.1877 218.147C85.1877 218.44 84.9349 218.679 84.6259 218.679L70.4112 218.557C70.1021 218.553 69.8471 218.318 69.8471 218.022V209.969C69.8471 209.684 70.1021 209.454 70.4112 209.445L84.6259 209.588C84.9349 209.596 85.1877 209.823 85.1877 210.111V218.147Z"
                                fill="#4F4F4F" />
                        </g>
                        <mask id="mask3_7_265" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="69" y="209"
                            width="17" height="10">
                            <path
                                d="M69.8483 209.968V218.021C69.8483 218.318 70.1022 218.553 70.4123 218.557L84.6259 218.679C84.9349 218.679 85.1888 218.439 85.1888 218.147V210.109C85.1888 209.822 84.9349 209.594 84.6259 209.588L70.4123 209.445C70.1022 209.453 69.8483 209.684 69.8483 209.968Z"
                                fill="white" />
                        </mask>
                        <g mask="url(#mask3_7_265)">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M81.5149 208.557L78.9474 208.533V209.977C78.9474 210.947 78.3041 211.732 77.5057 211.718C76.7257 211.718 76.0835 210.921 76.0835 209.961V208.496L73.5126 208.469C73.3506 208.48 73.1955 208.592 73.1955 208.764V213.296C73.1955 213.446 73.3506 213.588 73.5126 213.588L81.5149 213.657C81.6895 213.657 81.8273 213.526 81.8273 213.356V208.842C81.8273 208.682 81.6895 208.557 81.5149 208.557Z"
                                fill="#FEFEFE" />
                        </g>
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M76.6377 207.186V198.643H80.2116V207.219L76.6377 207.186Z" fill="#4F4F4F" />
                    </svg>
                    <div class="state-info">
                        <h3>Non Connecté</h3>
                        <h6>Dernière connection il y a {{timeAgo(live.date)}}</h6>
                        <hr>
                        <h3>Dernière valeur reçue :</h3>
                        <h4 class="text-box">Il y a {{timeAgo(live.date)}}</h4>
                        <hr>
                        <h3>Prochaine valeur estimée:</h3>
                        <h4 class="text-box">Dans {{nextValue(live.date)}}</h4>
                    </div>
                </div>
                <h2>Index Consommation : <span class="value">{{live.BASE / 1000}} kWh</span></h2>
                <h2>Mode : <span class="value">{{live.OPTARIF}}</span></h2>
                <hr>
                <h2>Version : <span class="value">{{config.VERSION}}</span></h2>
                <h2>Tension alim : <span class="value">{{live.VCONDO}} V</span></h2>

            </div>
            <div class="widget">
                <h1>Évolution conso.</h1>
                <!-- <div id="conso-percent" class="gauge-container two">
                </div> -->
                <div class="flex center">
                    <svg width="250" viewBox="0 0 327 272" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M253.716 26.186C226.377 8.85484 194.624 -0.234611 162.255 0.00460106C129.886 0.243813 98.2706 9.80157 71.1903 27.5349L163.5 168.5L253.716 26.186Z"
                            fill="#BBD41F" />
                        <path
                            d="M0.74151 124.889C11.8338 83.4918 38.2837 47.877 74.708 25.2931L163.5 168.5L0.74151 124.889Z"
                            fill="#48A23F" />
                        <path
                            d="M326.259 124.889C315.166 83.4919 288.716 47.8771 252.292 25.2931L163.5 168.5L326.259 124.889Z"
                            fill="#EAAA00" />
                        <g class="needle" filter="url(#filter0_d_0_1)">
                            <path
                                d="M162.503 25.8154C162.599 24.5854 164.401 24.5855 164.497 25.8154L172.509 128.808C172.555 129.389 172.095 129.886 171.512 129.886H155.488C154.905 129.886 154.445 129.389 154.491 128.808L162.503 25.8154Z"
                                fill="white" />
                        </g>
                        <circle cx="162" cy="169" r="102.5" fill="white" stroke="#C5C5C5" />
                        <path
                            d="M111.655 165.581V172.783H91.7548V165.581H111.655ZM138.289 147.364V191H129.063V156.121H128.807L118.814 162.385V154.203L129.617 147.364H138.289ZM164.597 191.597C161.586 191.597 158.901 191.043 156.544 189.935C154.2 188.827 152.339 187.3 150.961 185.354C149.583 183.408 148.866 181.178 148.809 178.663H157.758C157.857 180.354 158.568 181.724 159.889 182.776C161.21 183.827 162.779 184.352 164.597 184.352C166.046 184.352 167.325 184.033 168.433 183.393C169.555 182.74 170.428 181.838 171.053 180.688C171.693 179.523 172.012 178.187 172.012 176.682C172.012 175.148 171.686 173.798 171.032 172.634C170.393 171.469 169.505 170.56 168.369 169.906C167.232 169.253 165.933 168.919 164.47 168.905C163.191 168.905 161.948 169.168 160.741 169.693C159.548 170.219 158.617 170.936 157.95 171.845L149.747 170.375L151.813 147.364H178.49V154.906H159.42L158.291 165.837H158.546C159.313 164.757 160.471 163.862 162.019 163.152C163.568 162.442 165.301 162.087 167.218 162.087C169.846 162.087 172.19 162.705 174.249 163.94C176.309 165.176 177.936 166.874 179.129 169.033C180.322 171.178 180.911 173.649 180.897 176.447C180.911 179.388 180.23 182.001 178.852 184.288C177.488 186.561 175.578 188.351 173.12 189.658C170.677 190.95 167.836 191.597 164.597 191.597ZM211.217 182.818V180.517C211.217 178.77 211.586 177.165 212.325 175.702C213.078 174.224 214.164 173.045 215.585 172.165C217.019 171.27 218.767 170.822 220.826 170.822C222.914 170.822 224.669 171.263 226.089 172.143C227.524 173.024 228.603 174.203 229.328 175.68C230.066 177.143 230.436 178.756 230.436 180.517V182.818C230.436 184.565 230.066 186.178 229.328 187.655C228.589 189.118 227.502 190.29 226.068 191.17C224.633 192.065 222.886 192.513 220.826 192.513C218.738 192.513 216.984 192.065 215.563 191.17C214.143 190.29 213.063 189.118 212.325 187.655C211.586 186.178 211.217 184.565 211.217 182.818ZM217.417 180.517V182.818C217.417 183.827 217.659 184.778 218.142 185.673C218.639 186.568 219.534 187.016 220.826 187.016C222.119 187.016 222.999 186.575 223.468 185.695C223.951 184.814 224.193 183.855 224.193 182.818V180.517C224.193 179.48 223.965 178.514 223.511 177.619C223.056 176.724 222.161 176.277 220.826 176.277C219.548 176.277 218.66 176.724 218.163 177.619C217.666 178.514 217.417 179.48 217.417 180.517ZM188.823 157.847V155.545C188.823 153.784 189.2 152.172 189.953 150.709C190.705 149.232 191.792 148.053 193.213 147.172C194.647 146.291 196.38 145.851 198.411 145.851C200.514 145.851 202.275 146.291 203.695 147.172C205.116 148.053 206.195 149.232 206.934 150.709C207.673 152.172 208.042 153.784 208.042 155.545V157.847C208.042 159.608 207.666 161.22 206.913 162.683C206.174 164.146 205.088 165.318 203.653 166.199C202.232 167.065 200.485 167.499 198.411 167.499C196.338 167.499 194.583 167.058 193.149 166.178C191.728 165.283 190.649 164.111 189.91 162.662C189.186 161.199 188.823 159.594 188.823 157.847ZM195.066 155.545V157.847C195.066 158.884 195.308 159.842 195.791 160.723C196.288 161.604 197.161 162.044 198.411 162.044C199.718 162.044 200.606 161.604 201.075 160.723C201.558 159.842 201.799 158.884 201.799 157.847V155.545C201.799 154.509 201.572 153.543 201.117 152.648C200.663 151.753 199.761 151.305 198.411 151.305C197.147 151.305 196.274 151.76 195.791 152.669C195.308 153.578 195.066 154.537 195.066 155.545ZM191.636 191L221.636 147.364H227.218L197.218 191H191.636Z"
                            fill="#48A23F" />
                        <defs>
                            <filter id="filter0_d_0_1" x="150.487" y="20.8929" width="26.025" height="112.993"
                                filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                                <feFlood flood-opacity="0" result="BackgroundImageFix" />
                                <feColorMatrix in="SourceAlpha" type="matrix"
                                    values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
                                <feOffset />
                                <feGaussianBlur stdDeviation="2" />
                                <feComposite in2="hardAlpha" operator="out" />
                                <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0" />
                                <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_0_1" />
                                <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_0_1" result="shape" />
                            </filter>
                        </defs>
                    </svg>

                </div>
                <div class="text-below-gauge">
                    <h4>de consommation</h4>
                    <h5>sur les 30 derniers jours</h5>
                </div>





            </div>
        </div>
        <div class="widget main">
            <h1>Consommation électrique</h1>

            <div class="conso-container">
                <div class="period-selector">
                    <label id="today" @click="today()"><span>Aujourd'hui</span></label>
                    <input type="radio" name="period" v-model="period" value="day" id="day" checked>
                    <label for="day">Jour</label>
                    <input type="radio" name="period" v-model="period" value="week" id="week">
                    <label for="week">Semaine</label>
                    <input type="radio" name="period" v-model="period" value="month" id="month">
                    <label for="month">Mois</label>
                    <input type="radio" name="period" v-model="period" value="year" id="year">
                    <label for="year">Année</label>
                </div>
                <div class="flex horizontal">
                    <span @click="previous()" class="mdi mdi-chevron-left"></span>
                    <div v-if="startDisplayDate.getDay() == endDisplayDate.getDay()">
                        <p>Affichage des données du {{strStartDisplayDate}}</p>
                    </div>
                    <div v-else>
                        <p>Affichage des données du {{strStartDisplayDate}} au {{strEndDisplayDate}}</p>
                    </div>
                    <span @click="next()" class="mdi mdi-chevron-right"></span>
                </div>
                <canvas id="consoChart" width="700" height="400"></canvas>
            </div>

        </div>
        <div class="side">
            <div class="widget">
                <h1>Puissance</h1>
                <div class="flex center">
                    <svg width="250" viewBox="0 0 327 272" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M0.74151 124.889C10.3418 89.0602 31.4962 57.4005 60.9237 34.8199C90.3513 12.2394 126.407 -9.28589e-06 163.5 0C200.593 9.2859e-06 236.649 12.2394 266.076 34.82C295.504 57.4005 316.658 89.0603 326.259 124.889L163.5 168.5L0.74151 124.889Z"
                            fill="url(#paint0_angular_0_1)" />
                        <g class="needle" filter="url(#filter0_d_0_1)">
                            <path
                                d="M26.9294 129.569C25.7728 129.14 26.267 127.407 27.476 127.652L128.72 148.178C129.291 148.294 129.643 148.872 129.483 149.432L125.091 164.844C124.931 165.404 124.327 165.71 123.781 165.507L26.9294 129.569Z"
                                fill="white" />
                        </g>
                        <circle cx="164" cy="169" r="102.5" fill="white" stroke="#C5C5C5" />
                        <defs>
                            <filter id="filter0_d_0_1" x="22.2738" y="123.628" width="111.248" height="45.9416"
                                filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                                <feFlood flood-opacity="0" result="BackgroundImageFix" />
                                <feColorMatrix in="SourceAlpha" type="matrix"
                                    values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
                                <feOffset />
                                <feGaussianBlur stdDeviation="2" />
                                <feComposite in2="hardAlpha" operator="out" />
                                <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0" />
                                <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_0_1" />
                                <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_0_1" result="shape" />
                            </filter>
                            <radialGradient id="paint0_angular_0_1" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse"
                                gradientTransform="translate(163.5 169) scale(168.5)">
                                <stop offset="0.542541" stop-color="#48A23F" />
                                <stop offset="0.774553" stop-color="#BBD41F" />
                                <stop offset="0.891899" stop-color="#EAAA00" />
                                <stop offset="0.956298" stop-color="#E63A0F" />
                            </radialGradient>
                        </defs>
                    </svg>
                    <div class="text-below-gauge">
                        <h4>Intensité Instantanée</h4>
                    </div>
                    <div class="gauge-value flex">
                        <h1>{{live.PAPP / 1000}}</h1>
                        <h2>kW</h2>
                    </div>

                </div>




            </div>
            <div class="widget">
                <h1>Prix</h1>
                <div class="price-tab">
                    <div class="label">
                        <h5>1 jour : </h5>
                        <h5>1 semaine : </h5>
                        <h5>1 mois : </h5>
                        <h5>1 an : </h5>
                    </div>
                    <div class="price">
                        <h5>0.53€</h5>
                        <h5>0.53€</h5>
                        <h5>0.53€</h5>
                        <h5>0.53€</h5>
                    </div>

                </div>

            </div>
            <div class="widget">
                <h1>Heure Creuse / Pleine</h1>
                <!-- line with percentage of HCHP and HCHC -->
                <div class="line">
                    <div class="HCHP HC" style="width: 50%;">HC</div>
                    <div class="HCHP HP" style="width: 50%;">HP</div>
                </div>

            </div>
        </div>
    </div>

    <div class="settings-window">
        <div class="window-content">
            <h1>Paramètres</h1>
            <h2>SSID :</h2>
            <input type="text" v-model="config.SSID">
            <h2>Mot de passe:</h2>
            <input type="password" v-model="config.PASSWORD">
            <hr>
            <h2>Actualisation :</h2>
            <h2>Nb de mesures avant envoi :</h2>
            <hr>
            <label for="hchp"> HCHC</label>
            <input type="radio" name="tarif" id="hchp">
            <label for="hchp"> HCHC</label>
            <input type="radio" name="tarif" id="base">
            <hr>
            <h2>Prix :</h2>
            <input type="number" v-model="config.PRIX_BASE">


        </div>
    </div>
    <div class="window-background"></div>

</body>
<script src="./index.js"></script>

</html>